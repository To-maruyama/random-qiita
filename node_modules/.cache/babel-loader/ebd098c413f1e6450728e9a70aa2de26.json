{"ast":null,"code":"import _slicedToArray from \"/Users/maru/project/typless-sample/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/maru/project/typless-sample/src/index.tsx\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Rx from 'typeless/rx';\nimport { createModule, DefaultTypelessProvider } from 'typeless';\nimport QiitaRepository from './repository/Qiita';\n\nconst _createModule$withAct = createModule(Symbol('counter')) // Create Actions Creators\n.withActions({\n  $mounted: null,\n  getItems: keyword => ({\n    payload: {\n      keyword\n    }\n  }),\n  // null means no args\n  getItemsDone: (items, keyword) => ({\n    payload: {\n      items,\n      keyword\n    }\n  }),\n  getTags: null,\n  // null means no args\n  getTagsDone: tags => ({\n    payload: {\n      tags\n    }\n  })\n}).withState(),\n      _createModule$withAct2 = _slicedToArray(_createModule$withAct, 3),\n      useModule = _createModule$withAct2[0],\n      CounterActions = _createModule$withAct2[1],\n      getCounterState = _createModule$withAct2[2];\n\nexport { useModule, CounterActions, getCounterState };\n\n/* == Module Implementation == */\nconst initialState = {\n  items: [],\n  keyword: ''\n};\nconst repository = new QiitaRepository(); // Create Epic for side effects\n\nuseModule.epic() // Listen for `count` and dispatch `countDone` with 500ms delay\n.on(CounterActions.$mounted, () => {\n  return Rx.of(CounterActions.getTags());\n}).on(CounterActions.getTags, async () => {\n  const page = Math.floor(Math.random() * 99) + 1;\n  return repository.getTags(page).then(result => CounterActions.getTagsDone(result));\n}).on(CounterActions.getTagsDone, ({\n  tags\n}) => {\n  return Rx.of(CounterActions.getItems(tags.values));\n}).on(CounterActions.getItems, async ({\n  keyword\n}) => {\n  return repository.getItems(keyword).then(result => CounterActions.getItemsDone(result, keyword));\n}); // Create a reducer\n// Under the hood it uses `immer` and state mutations are allowed\n\nuseModule.reducer(initialState).on(CounterActions.getTagsDone, (state, {\n  tags\n}) => {\n  state.tags = tags;\n}).on(CounterActions.getItemsDone, (state, {\n  items,\n  keyword\n}) => {\n  state.keyword = keyword;\n  state.items = items;\n});\n/* == Use Module in React == */\n\nexport function Counter() {\n  // load epic and reducer\n  useModule(); // wrap actions with `dispatch`\n  // get state from store\n\n  const _getCounterState$useS = getCounterState.useState(),\n        items = _getCounterState$useS.items;\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, items.map((x, index) => React.createElement(\"div\", {\n    key: index,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, x.title)));\n}\nReactDOM.render(React.createElement(DefaultTypelessProvider, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 82\n  },\n  __self: this\n}, React.createElement(Counter, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 83\n  },\n  __self: this\n})), document.getElementById('app'));","map":{"version":3,"sources":["/Users/maru/project/typless-sample/src/index.tsx"],"names":["React","ReactDOM","Rx","createModule","DefaultTypelessProvider","QiitaRepository","Symbol","withActions","$mounted","getItems","keyword","payload","getItemsDone","items","getTags","getTagsDone","tags","withState","useModule","CounterActions","getCounterState","initialState","repository","epic","on","of","page","Math","floor","random","then","result","values","reducer","state","Counter","useState","map","x","index","title","render","document","getElementById"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAO,KAAKC,EAAZ,MAAoB,aAApB;AACA,SAASC,YAAT,EAAuBC,uBAAvB,QAAsD,UAAtD;AACA,OAAOC,eAAP,MAA4B,oBAA5B;;8BAM4DF,YAAY,CACtEG,MAAM,CAAC,SAAD,CADgE,CAAZ,CAG1D;AAH0D,CAIzDC,WAJyD,CAI7C;AACXC,EAAAA,QAAQ,EAAE,IADC;AAEXC,EAAAA,QAAQ,EAAGC,OAAD,KAAsB;AAAEC,IAAAA,OAAO,EAAE;AAAED,MAAAA;AAAF;AAAX,GAAtB,CAFC;AAEgD;AAC3DE,EAAAA,YAAY,EAAE,CAACC,KAAD,EAAqBH,OAArB,MAA0C;AAAEC,IAAAA,OAAO,EAAE;AAAEE,MAAAA,KAAF;AAASH,MAAAA;AAAT;AAAX,GAA1C,CAHH;AAIXI,EAAAA,OAAO,EAAE,IAJE;AAII;AACfC,EAAAA,WAAW,EAAGC,IAAD,KAAiB;AAAEL,IAAAA,OAAO,EAAE;AAAEK,MAAAA;AAAF;AAAX,GAAjB;AALF,CAJ6C,EAWzDC,SAXyD,E;;MAA9CC,S;MAAWC,c;MAAgBC,e;;;;AAkBzC;AAEA,MAAMC,YAA0B,GAAG;AACjCR,EAAAA,KAAK,EAAE,EAD0B;AAEjCH,EAAAA,OAAO,EAAE;AAFwB,CAAnC;AAKA,MAAMY,UAAU,GAAG,IAAIjB,eAAJ,EAAnB,C,CAEA;;AACAa,SAAS,CACNK,IADH,GAEE;AAFF,CAGGC,EAHH,CAGML,cAAc,CAACX,QAHrB,EAG+B,MAAO;AAAC,SAAON,EAAE,CAACuB,EAAH,CAAMN,cAAc,CAACL,OAAf,EAAN,CAAP;AAAuC,CAH9E,EAIGU,EAJH,CAIML,cAAc,CAACL,OAJrB,EAI8B,YAAW;AACrC,QAAMY,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAYD,IAAI,CAACE,MAAL,KAAgB,EAA5B,IAAmC,CAAhD;AACA,SAAOP,UAAU,CAACR,OAAX,CAAmBY,IAAnB,EAAyBI,IAAzB,CAA+BC,MAAD,IAAYZ,cAAc,CAACJ,WAAf,CAA2BgB,MAA3B,CAA1C,CAAP;AACD,CAPH,EAQGP,EARH,CAQML,cAAc,CAACJ,WARrB,EAQkC,CAAC;AAACC,EAAAA;AAAD,CAAD,KAAY;AAAC,SAAOd,EAAE,CAACuB,EAAH,CAAMN,cAAc,CAACV,QAAf,CAAwBO,IAAI,CAACgB,MAA7B,CAAN,CAAP;AAAmD,CARlG,EASGR,EATH,CASML,cAAc,CAACV,QATrB,EAS+B,OAAM;AAACC,EAAAA;AAAD,CAAN,KAAoB;AAC/C,SAAOY,UAAU,CAACb,QAAX,CAAoBC,OAApB,EAA6BoB,IAA7B,CAAmCC,MAAD,IAAYZ,cAAc,CAACP,YAAf,CAA4BmB,MAA5B,EAAoCrB,OAApC,CAA9C,CAAP;AACD,CAXH,E,CAaA;AACA;;AACAQ,SAAS,CACNe,OADH,CACWZ,YADX,EAEGG,EAFH,CAEML,cAAc,CAACJ,WAFrB,EAEkC,CAACmB,KAAD,EAAQ;AAAClB,EAAAA;AAAD,CAAR,KAAmB;AACjDkB,EAAAA,KAAK,CAAClB,IAAN,GAAaA,IAAb;AACD,CAJH,EAKGQ,EALH,CAKML,cAAc,CAACP,YALrB,EAKmC,CAACsB,KAAD,EAAQ;AAAErB,EAAAA,KAAF;AAASH,EAAAA;AAAT,CAAR,KAA+B;AAC9DwB,EAAAA,KAAK,CAACxB,OAAN,GAAgBA,OAAhB;AACAwB,EAAAA,KAAK,CAACrB,KAAN,GAAcA,KAAd;AACD,CARH;AAUA;;AAEA,OAAO,SAASsB,OAAT,GAAmB;AACxB;AACAjB,EAAAA,SAAS,GAFe,CAIxB;AACA;;AALwB,gCAMNE,eAAe,CAACgB,QAAhB,EANM;AAAA,QAMhBvB,KANgB,yBAMhBA,KANgB;;AAQxB,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGA,KAAK,CAACwB,GAAN,CAAU,CAACC,CAAD,EAAIC,KAAJ,KAAc;AAAK,IAAA,GAAG,EAAEA,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAkBD,CAAC,CAACE,KAApB,CAAxB,CADH,CADF;AAKD;AAEDvC,QAAQ,CAACwC,MAAT,CACE,oBAAC,uBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GACE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EADF,CADF,EAIEC,QAAQ,CAACC,cAAT,CAAwB,KAAxB,CAJF","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Rx from 'typeless/rx';\nimport { createModule, DefaultTypelessProvider } from 'typeless';\nimport QiitaRepository from './repository/Qiita'\nimport Item from './models/Item'\nimport {Tags} from './models/Tag'\n\n/* == Module Interface == */\n\nexport const [useModule, CounterActions, getCounterState] = createModule(\n  Symbol('counter')\n)\n  // Create Actions Creators\n  .withActions({\n    $mounted: null,\n    getItems: (keyword: string) => ({ payload: { keyword } }), // null means no args\n    getItemsDone: (items: Array<Item>, keyword: string) => ({ payload: { items, keyword } }),\n    getTags: null, // null means no args\n    getTagsDone: (tags: Tags) => ({ payload: { tags } }),\n  })\n  .withState<CounterState>();\n\nexport interface CounterState {\n  items: Array<Item>,\n  keyword: string\n}\n\n/* == Module Implementation == */\n\nconst initialState: CounterState = {\n  items: [],\n  keyword: ''\n};\n\nconst repository = new QiitaRepository()\n\n// Create Epic for side effects\nuseModule\n  .epic()\n  // Listen for `count` and dispatch `countDone` with 500ms delay\n  .on(CounterActions.$mounted, ()  => {return Rx.of(CounterActions.getTags())})\n  .on(CounterActions.getTags, async() => {\n    const page = Math.floor( Math.random() * 99 ) + 1\n    return repository.getTags(page).then((result) => CounterActions.getTagsDone(result))\n  })\n  .on(CounterActions.getTagsDone, ({tags}) => {return Rx.of(CounterActions.getItems(tags.values))})\n  .on(CounterActions.getItems, async({keyword}) => {\n    return repository.getItems(keyword).then((result) => CounterActions.getItemsDone(result, keyword))\n  });\n\n// Create a reducer\n// Under the hood it uses `immer` and state mutations are allowed\nuseModule\n  .reducer(initialState)\n  .on(CounterActions.getTagsDone, (state, {tags}) => {\n    state.tags = tags\n  })\n  .on(CounterActions.getItemsDone, (state, { items, keyword }) => {\n    state.keyword = keyword;\n    state.items = items;\n  });\n\n/* == Use Module in React == */\n\nexport function Counter() {\n  // load epic and reducer\n  useModule();\n\n  // wrap actions with `dispatch`\n  // get state from store\n  const { items } = getCounterState.useState();\n\n  return (\n    <div>\n      {items.map((x, index) => <div key={index}>{x.title}</div>)}\n    </div>\n  );\n}\n\nReactDOM.render(\n  <DefaultTypelessProvider>\n    <Counter />\n  </DefaultTypelessProvider>,\n  document.getElementById('app')\n);"]},"metadata":{},"sourceType":"module"}